{"ast":null,"code":"import _slicedToArray from\"C:/Users/bobso/Desktop/React Projects/07-authentication/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useRef,useContext}from\"react\";import AuthContext from\"../../store/auth-context\";import{useHistory}from\"react-router-dom\";import classes from\"./AuthForm.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AuthForm=function AuthForm(){var history=useHistory();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLogin=_useState2[0],setIsLogin=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var authCtx=useContext(AuthContext);var emailInputRef=useRef();var passwordInputRef=useRef();var switchAuthModeHandler=function switchAuthModeHandler(){setIsLogin(function(prevState){return!prevState;});};var submitHandler=function submitHandler(event){event.preventDefault();var enteredEmail=emailInputRef.current.value;var eneteredPassword=passwordInputRef.current.value;// optional: Add validation\nsetIsLoading(true);var url;if(isLogin){url=\"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDOFmuibYVitUo0fyzOm24I32SlqUm7NOc\";}else{url=\"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDOFmuibYVitUo0fyzOm24I32SlqUm7NOc\";}fetch(url,{method:\"POST\",body:JSON.stringify({email:enteredEmail,password:eneteredPassword,returnSecureToken:true}),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){setIsLoading(false);if(res.ok){emailInputRef.current.value=\"\";passwordInputRef.current.value=\"\";return res.json();}else{passwordInputRef.current.value=\"\";passwordInputRef.current.focus();return res.json().then(function(data){// show an error modal\n// console.log(data.error.message);\nvar errorMessage=\"Authentication failed!\";if(data&&data.error&&data.error.message){errorMessage=data.error.message;}throw new Error(errorMessage);});}}).then(function(data){var expirationTime=new Date(new Date().getTime()+3*60*1000);authCtx.login(data.idToken,expirationTime.toISOString());history.replace(\"/\");}).catch(function(err){alert(err.message);});};return/*#__PURE__*/_jsxs(\"section\",{className:classes.auth,children:[/*#__PURE__*/_jsx(\"h1\",{children:isLogin?\"Login\":\"Sign Up\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.control,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Your Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",required:true,ref:emailInputRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.control,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Your Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",required:true,ref:passwordInputRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[!isLoading&&/*#__PURE__*/_jsx(\"button\",{children:isLogin?\"Login\":\"Create Account\"}),isLoading&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"white\"},children:\"Sending request...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:classes.toggle,onClick:switchAuthModeHandler,children:isLogin?\"Create new account\":\"Login with existing account\"})]})]})]});};export default AuthForm;","map":{"version":3,"names":["useState","useRef","useContext","AuthContext","useHistory","classes","AuthForm","history","isLogin","setIsLogin","isLoading","setIsLoading","authCtx","emailInputRef","passwordInputRef","switchAuthModeHandler","prevState","submitHandler","event","preventDefault","enteredEmail","current","value","eneteredPassword","url","fetch","method","body","JSON","stringify","email","password","returnSecureToken","headers","then","res","ok","json","focus","data","errorMessage","error","message","Error","expirationTime","Date","getTime","login","idToken","toISOString","replace","catch","err","alert","auth","control","actions","color","toggle"],"sources":["C:/Users/bobso/Desktop/React Projects/07-authentication/src/components/Auth/AuthForm.js"],"sourcesContent":["import { useState, useRef, useContext } from \"react\";\nimport AuthContext from \"../../store/auth-context\";\nimport { useHistory } from \"react-router-dom\";\n\nimport classes from \"./AuthForm.module.css\";\n\nconst AuthForm = () => {\n\tconst history = useHistory();\n\tconst [isLogin, setIsLogin] = useState(true);\n\tconst [isLoading, setIsLoading] = useState(false);\n\n\tconst authCtx = useContext(AuthContext);\n\n\tconst emailInputRef = useRef();\n\tconst passwordInputRef = useRef();\n\n\tconst switchAuthModeHandler = () => {\n\t\tsetIsLogin((prevState) => !prevState);\n\t};\n\n\tconst submitHandler = (event) => {\n\t\tevent.preventDefault();\n\n\t\tlet enteredEmail = emailInputRef.current.value;\n\t\tlet eneteredPassword = passwordInputRef.current.value;\n\n\t\t// optional: Add validation\n\n\t\tsetIsLoading(true);\n\t\tlet url;\n\n\t\tif (isLogin) {\n\t\t\turl =\n\t\t\t\t\"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDOFmuibYVitUo0fyzOm24I32SlqUm7NOc\";\n\t\t} else {\n\t\t\turl =\n\t\t\t\t\"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDOFmuibYVitUo0fyzOm24I32SlqUm7NOc\";\n\t\t}\n\n\t\tfetch(url, {\n\t\t\tmethod: \"POST\",\n\t\t\tbody: JSON.stringify({\n\t\t\t\temail: enteredEmail,\n\t\t\t\tpassword: eneteredPassword,\n\t\t\t\treturnSecureToken: true,\n\t\t\t}),\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t},\n\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tsetIsLoading(false);\n\t\t\t\tif (res.ok) {\n\t\t\t\t\temailInputRef.current.value = \"\";\n\t\t\t\t\tpasswordInputRef.current.value = \"\";\n\n\t\t\t\t\treturn res.json();\n\t\t\t\t} else {\n\t\t\t\t\tpasswordInputRef.current.value = \"\";\n\t\t\t\t\tpasswordInputRef.current.focus();\n\n\t\t\t\t\treturn res.json().then((data) => {\n\t\t\t\t\t\t// show an error modal\n\t\t\t\t\t\t// console.log(data.error.message);\n\t\t\t\t\t\tlet errorMessage = \"Authentication failed!\";\n\t\t\t\t\t\tif (data && data.error && data.error.message) {\n\t\t\t\t\t\t\terrorMessage = data.error.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthrow new Error(errorMessage);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((data) => {\n\t\t\t\tconst expirationTime = new Date(new Date().getTime() + 3 * 60 * 1000);\n\n\t\t\t\tauthCtx.login(data.idToken, expirationTime.toISOString());\n\t\t\t\thistory.replace(\"/\");\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\talert(err.message);\n\t\t\t});\n\t};\n\n\treturn (\n\t\t<section className={classes.auth}>\n\t\t\t<h1>{isLogin ? \"Login\" : \"Sign Up\"}</h1>\n\t\t\t<form onSubmit={submitHandler}>\n\t\t\t\t<div className={classes.control}>\n\t\t\t\t\t<label htmlFor=\"email\">Your Email</label>\n\t\t\t\t\t<input type=\"email\" id=\"email\" required ref={emailInputRef} />\n\t\t\t\t</div>\n\t\t\t\t<div className={classes.control}>\n\t\t\t\t\t<label htmlFor=\"password\">Your Password</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tref={passwordInputRef}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className={classes.actions}>\n\t\t\t\t\t{!isLoading && (\n\t\t\t\t\t\t<button>{isLogin ? \"Login\" : \"Create Account\"}</button>\n\t\t\t\t\t)}\n\t\t\t\t\t{isLoading && <p style={{ color: \"white\" }}>Sending request...</p>}\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tclassName={classes.toggle}\n\t\t\t\t\t\tonClick={switchAuthModeHandler}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isLogin ? \"Create new account\" : \"Login with existing account\"}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</section>\n\t);\n};\n\nexport default AuthForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}